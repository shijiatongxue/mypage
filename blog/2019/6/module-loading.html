<!DOCTYPE html>
<html lang="ch">
    <head>
        <link rel="icon" href="https://shijiatongxue.github.io/images/sj.png" type="image/png">
        <link rel="shortcut icon" href="https://shijiatongxue.github.io/images/sj.png" type="image/png">
        <link rel="stylesheet" href="https://shijiatongxue.github.io/styles/article.css">
        <title></title>
    </head>
    <body>
        <!-- 输入文章类别：JavaScript -->
        <article>
            <h1>模块加载方案</h1>
            <p class="info">作者：石嘉</p>
            <p class="info">日期：2019年6月30日</p>
            <p class="info">参考：<a href="https://github.com/mqyqingfeng/Blog/issues/108">冴羽</a></p>
            <h1>概述</h1>
            <p>模块加载有四种规范：</p>
            <ul>
                <li>AMD</li>
                <li>CMD</li>
                <li>CommonJS</li>
                <li>ES6</li>
            </ul>
            <h1>require.js</h1>
            <p>require是模块化的工具，会自动加载依赖的模块。</p>
            <p>工程目录：</p>
            <ul>
                <li>Project<ul>
                <li>index.html</li>
                <li>scripts/<ul>
                <li>main.js</li>
                <li>require.js</li>
                <li>add.js</li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
            <p>具体内容：</p>
            <ul>
            <li><p>配置html文件</p>
            <pre>
                <code class="lang-html">
                    &lt;script data-main=&quot;scripts/main&quot; src=&quot;scripts/require.js&quot;&gt;&lt;/script&gt;
                </code>
            </pre>
            </li>
            <li><p>main.js</p>
                <pre>
                    <code class="lang-js">
                        require([&#39;./add&#39;], function(addModule){
                            console.log(addModule.add(1, 1));
                        });
                    </code>
                </pre>
            </li>
            <li><p>add.js</p>
            <pre>
                <code class="lang-js">
                    define(function(){
                        var add = function(x, y){
                        return x + y;
                        };

                        return {
                            add: add;
                        };
                    })
                </code>
            </pre>
            </li>
            </ul>
            <p>所以引入模块需要require，定义模块内容需要define。</p>
            <h1>AMD</h1>
            <p>AMD是RequireJS在推广过程中对模块定义的规范。</p>
            <h1>sea.js</h1>
            <p>同样的工程，sea.js需要这样写。</p>
            <ul>
            <li>index.html
                <pre>
                    <code class="lang-html">
                        &lt;script src=&quot;scripts/sea.js&quot;&gt;&lt;/script&gt;
                        &lt;script&gt;
                            sea.use(&quot;./scripts/main.js&quot;);
                        &lt;/script&gt;
                    </code>
                </pre>
            </li>
            <li>main.js
                <pre>
                    <code class="lang-js">define(function(require, exports, module){
                        // 需要时导入依赖的模块
                        var addModule = require(&#39;./add&#39;);
                        console.log(addModule.add(1, 1));
                    });
                    </code>
                </pre>
            </li>
            <li>add.js
                <pre>
                    <code class="lang-js">
                        define(function(require, exports, module){
                            var add = function(a, b){
                                return a + b;
                            };
                            // 导出add函数
                            module.exports = {
                                add: add;
                            };
                        });
                    </code>
                </pre>
            </li>
            </ul>
            <h1>CMD</h1>
            <p>CMD是在SeaJS在推广过程中对模块定义的规范。</p> 
            <h1>AMD与CMD的区别</h1>
            <ul>
            <li>引入方式不同</li>
            </ul>
            <p>AMD在定义模块时，所需的依赖必须一开始就写好。</p>
            <pre><code class="lang-js">// AMD
            require([&#39;./add&#39;], function(addModule){
                console.log(addModule.add(1, 1));
            });
            </code></pre>
            <p>CMD则是需要时再require。</p>
            <pre><code class="lang-js">// CMD
            define(function(require, exports, module){
                var addModule = require(&#39;./add&#39;);
                console.log(addModule.add(1, 1));
            })
            </code></pre>
            <ul>
            <li>加载的时机不同</li>
            </ul>
            <p>AMD需要将需要的依赖先加载完再执行代码，而CMD则是在require的时候再加载依赖，加载完后执行。</p>
            <h1>CommonJS</h1>
            <p>服务器端采用的是CommonJS规范。</p>
            <ul>
            <li>导入模块<pre><code class="lang-js">
            var add = require(&#39;./add.js&#39;);
            console(add.add(1, 1));
            </code></pre>
            </li>
            <li>导出模块<pre><code class="lang-js">
            var add = function(a, b){
                return a + b;
            }
            module.exports.add = add;
            </code></pre>
            </li>
            </ul>
            <h1>CommonJS与AMD</h1>
            <ul>
            <li>CommonJS：同步，加载完才能执行后面操作。</li>
            <li>AMD：异步，允许指定回调函数。</li>
            </ul>
            <p>基于服务器端和浏览器端的环境的特点，加载模块的方式：</p>
            <ul>
            <li>服务器端：CommonJS</li>
            <li>浏览器端：AMD</li>
            </ul>
            <h1>ES6</h1>
            <ul>
            <li>导入模块<pre><code class="lang-js">import {one, two, three} from &#39;./file&#39;
            </code></pre>
            </li>
            <li>导出模块
            <pre>
                <code class="lang-js">
                    var one = &#39;hello&#39;;
                    var two = &#39;two&#39;;
                    var three = &#39;three&#39;;
                    
                    export {one, two, three};
                </code>
            </pre>
            </li>
            </ul>
            <ul>
                <li>html设置</li>
                <pre>
                    <code class="lang-html">
                        &lt;!-- 其中，type=&quot;module&quot;是必须要设置的。 --&gt;
                        &lt;script src=&quot;scripts/main.js&quot; type=&quot;module&quot;&gt;
                    </code>
                </pre>
            </ul>
            <h1 id="es6-commonjs">ES6与CommonJS</h1>
            <p>不同点：</p>
            <ul>
            <li>CommonJS模块输出的是一个值的拷贝，ES6输出的是值的引用；</li>
            <li>CommonJS模块是运行时加载，ES6是编译时输出接口。</li>
            </ul>
            <h1 id="es6-es5">ES6转为ES5</h1>
            <ul>
            <li>首先使用Babel将ES6代码转为CommonJS代码；</li>
            <li>再使用webpack将CommonJS代码转为原生的ES5代码。</li>
            </ul>
            <p>（完）</p>
        </article>
        <script src="https://shijiatongxue.github.io/js/prism.js"></script>
    </body>
</html>